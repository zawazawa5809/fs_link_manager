# FS Link Manager - インポートファイル形式

## 概要
FS Link Managerは、JSON形式のファイルからリンク情報をインポートできます。

## サポートされているJSON形式

### 1. リスト形式（推奨）
複数のリンクを配列として定義します。

```json
[
  {
    "name": "ファイル名",
    "path": "C:\\パス\\ファイル.txt",
    "tags": "タグ1,タグ2",
    "position": 0,
    "added_at": "2025-01-19T10:00:00"
  },
  {
    "name": "別のファイル",
    "path": "\\\\サーバー\\共有\\ファイル.doc",
    "tags": "ネットワーク",
    "position": 1,
    "added_at": "2025-01-19T11:00:00"
  }
]
```

### 2. 単一オブジェクト形式
単一のリンクをオブジェクトとして定義（自動的にリストに変換されます）。

```json
{
  "name": "ファイル名",
  "path": "C:\\パス\\ファイル.txt",
  "tags": "タグ",
  "position": 0,
  "added_at": "2025-01-19T10:00:00"
}
```

## フィールド説明

| フィールド | 必須 | 説明 | 例 |
|-----------|------|------|-----|
| `name` | いいえ | リンクの表示名。省略時はパスのファイル名部分が使用される | "プロジェクト仕様書" |
| `path` | **はい** | ファイルまたはフォルダのパス | "C:\\Documents\\file.txt" |
| `tags` | いいえ | カンマ区切りのタグ | "重要,仕様書" |
| `position` | いいえ | 表示順序（エクスポート時に自動設定） | 0 |
| `added_at` | いいえ | 追加日時（ISO形式） | "2025-01-19T10:00:00" |

## 重要な注意事項

1. **`path`フィールドは必須です** - これがないとリンクはインポートされません
2. パスには以下が使用できます：
   - ローカルパス: `C:\\folder\\file.txt`
   - UNCパス: `\\\\server\\share\\file.txt`
   - フォルダパス: `C:\\Documents`
3. 特殊文字（日本語、絵文字など）も使用可能
4. `name`が省略された場合、パスからファイル名が自動生成されます

## サンプルファイル

`sample_import.json` ファイルが同梱されています。これを参考にインポートファイルを作成できます。

## エラー時のログ確認

インポートが失敗した場合、`fs_link_manager.log` ファイルに詳細なエラー情報が記録されます。

## よくある問題

### 問題: "no path specified" エラー
**原因**: JSONオブジェクトに`path`フィールドがない
**解決**: 各リンクオブジェクトに`path`フィールドを追加してください

### 問題: "Invalid JSON format" エラー
**原因**: JSONファイルの形式が正しくない、または別のアプリケーションのエクスポートファイル
**解決**: 上記の形式に従ってJSONファイルを作成してください

### 問題: 文字化け
**原因**: ファイルのエンコーディングがUTF-8でない
**解決**: JSONファイルをUTF-8エンコーディングで保存してください